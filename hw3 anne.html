<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Homework 3</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Homework 3</h1>

<h2>Question 1</h2>

<p><em>Read  the  World  Bank  webpage  and  store  as  a  nice  data  frame.</em><br/>
<em>Source:  The  data  can  be  found  here: <a href="http://wdi.worldbank.org/table/4.1">http://wdi.worldbank.org/table/4.1</a></em><br/>
<em>Hints:  You  can  try  readHTMLTable</em><br/>
<em>We  are  interested  in  the  third  table. [[3]]  will  select  the  third  element  in  a list.  Store  as  a  data  frame.  Rename  the  columns  to  be  meaningful.</em> </p>

<pre><code class="r">require(XML)
url &lt;- &quot;http://wdi.worldbank.org/table/4.1&quot;
mytable &lt;- readHTMLTable(url, colClasses = c(&quot;character&quot;, rep(&quot;numeric&quot;, 10)))[[3]]
</code></pre>

<p>I check my result with</p>

<pre><code class="r">str(mytable)
</code></pre>

<p>To sum up, I have a dataframe with country names as characters and other columns containing numbers, and a lot of NAs where there are no values.</p>

<p>Some cleaning up, and naming the columns</p>

<pre><code class="r">mytable[, 1] &lt;- tolower(mytable[, 1])
names(mytable)[1] &lt;- &quot;Country&quot;

h1 &lt;- c(&quot;GDP&quot;, &quot;Agriculture&quot;, &quot;Industry&quot;, &quot;Manufacturing&quot;, &quot;Services&quot;)
h2 &lt;- c(&quot;1990to2000&quot;, &quot;2000to2012&quot;)

k &lt;- 2
for (i in h1) {
    for (j in h2) {
        names(mytable)[k] &lt;- paste0(i, j)
        k &lt;- 1 + k
    }
}
</code></pre>

<p>My end result looks like</p>

<pre><code>##          Country GDP1990to2000 GDP2000to2012
## 1    afghanistan            NA           9.4
## 2        albania           3.8           5.0
## 3        algeria           1.9           3.7
## 4 american samoa            NA            NA
## 5        andorra           3.2           5.9
</code></pre>

<h2>Question 2</h2>

<p><em>Write  an  R  function  that  will  take  the name of  a  country  and  return  its  Avg Industrial  Growth  value for 2000‚Äê2012.(Use your dataframe as the data source for your function to look up)</em></p>

<pre><code class="r">iG2000 &lt;- function(country) {
    # the function assumes my dataframe is in my environment
    country &lt;- tolower(country)
    if (!(country %in% mytable[, &quot;Country&quot;])) {
        stop(&quot;invalid country name&quot;)
    }

    print(paste(country, mytable[mytable$Country == country, &quot;Industry2000to2012&quot;], 
        sep = &quot; &quot;))
}
# I give 2 examples
iG2000(&quot;france&quot;)
</code></pre>

<pre><code>## [1] &quot;france 0&quot;
</code></pre>

<pre><code class="r">iG2000(&quot;india&quot;)
</code></pre>

<pre><code>## [1] &quot;india 8.2&quot;
</code></pre>

<h2>Question 3</h2>

<p><em>By  using  R  to  read  from Wikipedia,  create  a  data  frame  that  contains the names  of  countries and  their Healthcare  expenditure.  You  can  use  any wikipedia page  that  has  a  population  table  in  it. You  can  use any measure  of  healthcare  spending  that  you  find or  like</em></p>

<p>I will be using this page <a href="http://en.wikipedia.org/wiki/Health_care_system">http://en.wikipedia.org/wiki/Health_care_system</a>. It contains data about 10 countries and gives the healthcare cost as percent of GDP. I am interested in the 1st and 8th columns.
Here is what I did and the result:</p>

<pre><code class="r">url &lt;- &quot;http://en.wikipedia.org/wiki/Health_care_system&quot;
mytable &lt;- readHTMLTable(url, colClasses = c(&quot;character&quot;, rep(&quot;numeric&quot;, 9)))[[1]]
healthCost &lt;- mytable[, c(1, 8)]
healthCost
</code></pre>

<pre><code>##      Country Healthcare costs as a percent of GDP
## 1  Australia                                  8.5
## 2     Canada                                 10.0
## 3     France                                 11.0
## 4    Germany                                 10.4
## 5      Italy                                  8.7
## 6      Japan                                  8.2
## 7     Norway                                  8.9
## 8     Sweden                                  8.9
## 9         UK                                  8.4
## 10       USA                                 16.0
</code></pre>

<p><strong><em>BONUS</em></strong>  </p>

<p>As I was browsing in search of data for my project, I stumbled upon some CIA&#39;s datasets.<br/>
They happen to have health costs per GDP data, so let&#39;s see if wikipedia/OECD and the CIA data match.<br/>
I downloaded the data from <a href="https://www.cia.gov/library/publications/the-world-factbook/rankorder/rawdata_2225.txt">https://www.cia.gov/library/publications/the-world-factbook/rankorder/rawdata_2225.txt</a> for the CIA set and <a href="http://stats.oecd.org/">http://stats.oecd.org/</a> for the OECD set.
After much trouble I ended up saving the data to my working directory (you can see the frustration in me going back to french)</p>

<pre><code class="r">cia &lt;- read.table(&quot;../ciahealth.txt&quot;, sep = &quot;\t&quot;, quote = &quot;&quot;, colClasses = c(&quot;NULL&quot;, 
    &quot;character&quot;, &quot;numeric&quot;))
cia[, 1] &lt;- tolower(cia[, 1])
ocde &lt;- read.csv(&quot;../depensesSante.csv&quot;, header = T)
# This data set contains 3 columns:country, health cost general govt
# expense, total expense
names(ocde) &lt;- c(&quot;country&quot;, &quot;gvtExpense&quot;, &quot;totExpense&quot;)
ocde &lt;- within(ocde, country &lt;- tolower(as.character(country)))
ocde &lt;- within(ocde, gvtExpense &lt;- as.numeric(as.character(gvtExpense)))
ocde &lt;- within(ocde, totExpense &lt;- as.numeric(as.character(totExpense)))
</code></pre>

<p>I merge the 2 datasets on country name. Since cia contains 190 countries and ocde 34, so I expect at most 34 rows.</p>

<pre><code class="r">cia.ocde &lt;- merge(cia, ocde, by.x = &quot;V2&quot;, by.y = &quot;country&quot;)
names(cia.ocde) &lt;- c(&quot;country&quot;, &quot;cia&quot;, &quot;gvtExpense&quot;, &quot;totExpense&quot;)
</code></pre>

<p>I see only 32 countries.
After cheking, 2 countries show a different name in the 2 data sets.
However, the most pressing issues is that only 0 values match.
With summary, can see some data closely match though  </p>

<pre><code>##    country               cia          gvtExpense     totExpense   
##  Length:32          Min.   : 6.00   Min.   :3.25   Min.   : 5.85  
##  Class :character   1st Qu.: 7.70   1st Qu.:6.00   1st Qu.: 8.51  
##  Mode  :character   Median : 9.30   Median :7.07   Median : 9.03  
##                     Mean   : 9.44   Mean   :6.85   Mean   : 9.34  
##                     3rd Qu.:10.60   3rd Qu.:7.96   3rd Qu.:10.49  
##                     Max.   :17.90   Max.   :9.49   Max.   :16.99  
##                                     NA&#39;s   :6      NA&#39;s   :5
</code></pre>

<p>They do not share the same source, I give a look at the World Bank data
I could only get 2012 data, so I will have to look for similar data, and not a perfect match.</p>

<pre><code class="r">url &lt;- &quot;http://wdi.worldbank.org/table/2.15&quot;
wb &lt;- readHTMLTable(url, colClasses = c(&quot;character&quot;, rep(&quot;numeric&quot;, 10)), which = 3)
wb &lt;- wb[, 1:2]
wb &lt;- within(wb, V1 &lt;- tolower(V1))
cia.ocde.wb &lt;- merge(cia.ocde, wb, by.x = &quot;country&quot;, by.y = &quot;V1&quot;)
colnames(cia.ocde.wb)[5] &lt;- &quot;wb&quot;
</code></pre>

<p>I get an overview</p>

<pre><code class="r">summary(cia.ocde.wb)
</code></pre>

<pre><code>##    country               cia          gvtExpense     totExpense   
##  Length:32          Min.   : 6.00   Min.   :3.25   Min.   : 5.85  
##  Class :character   1st Qu.: 7.70   1st Qu.:6.00   1st Qu.: 8.51  
##  Mode  :character   Median : 9.30   Median :7.07   Median : 9.03  
##                     Mean   : 9.44   Mean   :6.85   Mean   : 9.34  
##                     3rd Qu.:10.60   3rd Qu.:7.96   3rd Qu.:10.49  
##                     Max.   :17.90   Max.   :9.49   Max.   :16.99  
##                                     NA&#39;s   :6      NA&#39;s   :5      
##        wb       
##  Min.   : 5.90  
##  1st Qu.: 7.78  
##  Median : 9.25  
##  Mean   : 9.41  
##  3rd Qu.:10.82  
##  Max.   :17.90  
## 
</code></pre>

<p>I can see the CIA and World Bank converge.<br/>
A plot ?</p>

<pre><code class="r">library(reshape2)
library(ggplot2)
</code></pre>

<pre><code class="r">ordered &lt;- cia.ocde.wb[order(cia.ocde.wb$wb), ]
order.melt &lt;- melt(ordered, id.vars = &quot;country&quot;)
order.melt$country &lt;- factor(order.melt$country, levels = unique(order.melt$country), 
    ordered = T)
require(ggplot2)
p &lt;- ggplot(data = order.melt, aes(x = country, y = value, colour = variable, 
    group = variable))
p &lt;- p + geom_point(size = 2.5) + theme(axis.text.x = element_text(angle = 90, 
    vjust = 0.5, hjust = 1))
p &lt;- p + ylab(&quot;Healthcare Cost as percent of GDP&quot;)
p
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<p>We can see some CIA closer to the World Bank data than the OECD ones, is it their source, or do they compile their own data set from scratch. We can see some discrepancies though, but since we live in a period of crisis, it can be explained by either a change in countries GDP between 2011 and 2012 or a change in health care policies.
I plotted the government expense as well, and though we can see some kind of linear dependency between the government expense and the total expense, I am not sure it would be relevant.</p>

<h2>Question 4</h2>

<p><em>Read the data file: KCASANTA142.csv</em><br/>
<em>Notice that it has one column  that    has the time and    the date    and the time combined</em><br/>
<em>Create new columns for Month,  Day,    Year,   Hour    and Minute  in  the data    frame.</em> 
<em>You    can write   a   function    and use lapply()</em>   </p>

<p>The file is in my working directory</p>

<pre><code class="r">mydf &lt;- read.csv(&quot;../KCASANTA142.csv&quot;, stringsAsFactors = F)
# I take my Time column and will make a list
timelist &lt;- strsplit(mydf$Time, &quot;\\-+|\\ |\\:&quot;)
# I reshape it as a df
library(&quot;plyr&quot;)
timedf &lt;- ldply(timelist)
colnames(timedf) &lt;- c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;hour&quot;, &quot;minute&quot;, &quot;second&quot;)
# I make my nice new df
mynewdf &lt;- cbind(temperature = mydf$TemperatureF, timedf[, c(&quot;month&quot;, &quot;day&quot;, 
    &quot;year&quot;, &quot;hour&quot;, &quot;minute&quot;)])
</code></pre>

<p>After all that I have a 84482 by 6 data frame looking like</p>

<pre><code class="r">head(mynewdf)
</code></pre>

<pre><code>##   temperature month day year hour minute
## 1        49.5    01  01 2011   00     02
## 2        49.5    01  01 2011   00     07
## 3        49.4    01  01 2011   00     12
## 4        49.3    01  01 2011   00     18
## 5        49.3    01  01 2011   00     23
## 6        49.2    01  01 2011   00     28
</code></pre>

<p><em>Crate a new data frame that would give at most one measure per hour.</em></p>

<p>I can see 3 possibilities to do so, here they are and the result</p>

<pre><code class="r">perhour &lt;- aggregate(temperature ~ hour + day + month + year, data = mynewdf, 
    FUN = mean)
perhour2 &lt;- ddply(mynewdf, .(year, month, day, hour), summarise, meanTemp = mean(temperature))
library(dplyr)
perhour3 &lt;- mynewdf %.% group_by(year, month, day, hour) %.% summarise(meanTemp = mean(temperature))
dim(perhour)
</code></pre>

<pre><code>## [1] 8641    5
</code></pre>

<pre><code class="r">dim(perhour2)
</code></pre>

<pre><code>## [1] 8641    5
</code></pre>

<pre><code class="r">dim(perhour3)
</code></pre>

<pre><code>## [1] 8641    5
</code></pre>

<pre><code class="r">head(perhour2)
</code></pre>

<pre><code>##   year month day hour meanTemp
## 1 2011    01  01   00    49.26
## 2 2011    01  01   01    49.23
## 3 2011    01  01   02    49.58
## 4 2011    01  01   03    47.21
## 5 2011    01  01   04    47.08
## 6 2011    01  01   05    47.80
</code></pre>

</body>

</html>

